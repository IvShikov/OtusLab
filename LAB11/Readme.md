# Лабораторная работа №11. Настройка протокола OSPFv2 для одной области

![](https://github.com/IvShikov/OtusLab/blob/main/LAB11/Lab11_Topology%20and%20Table.JPG)

# Цели:
## Часть 1. Создание сети и настройка основных параметров устройства
## Часть 2. Настройка и проверка базовой работы протокола OSPFv2 для одной области
## Часть 3. Оптимизация и проверка конфигурации OSPFv2 для одной областиСоздание сети и настройка основных параметров устройства
##
# Общие сведения и сценарий:
Нам поручено настроить сеть небольшой компании с помощью OSPFv2. R1 будет размещать интернет-соединение (имитируемое интерфейсом Loopback 1) и делиться информацией о маршруте по умолчанию до R2. После первоначальной настройки организация попросила оптимизировать конфигурацию, чтобы уменьшить трафик протокола и гарантировать, что R1 продолжает контролировать маршрутизацию.

**Примечание**. Статическая маршрутизация, используемая в данной лаборатории, заключается в оценке возможности настройки и настройки OSPFv2 в конфигурации для одной области. Этот подход, используемый в данной лаборатории, может не отражать рекомендации по работе с сетевыми сетями.

**Примечание:** Маршрутизаторы, используемые в практических лабораторных работах CCNA, - это Cisco 4221 с Cisco IOS XE Release 16.9.4 (образ universalk9). В лабораторных работах используются коммутаторы Cisco Catalyst 2960 с Cisco IOS версии 15.2(2) (образ lanbasek9). Можно использовать другие маршрутизаторы, коммутаторы и версии Cisco IOS. В зависимости от модели устройства и версии Cisco IOS доступные команды и результаты их выполнения могут отличаться от тех, которые показаны в лабораторных работах. Правильные идентификаторы интерфейса см. в сводной таблице по интерфейсам маршрутизаторов в конце лабораторной работы.

**Примечание**. Следует убедиться, что у всех маршрутизаторов и коммутаторов была удалена начальная конфигурация. 
## Необходимые ресурсы:

 - 2 маршрутизатора (Cisco 4221 с универсальным образом Cisco IOS XE версии 16.9.4 или аналогичным)
 - 2 коммутатора (Cisco 2960 с образом lanbasek9 Cisco IOS версии 15.2 (2) или аналогичным) - опционально
 - 1 ПК (ОС Windows с программой эмуляции терминалов, такой как Cisco Packet Tracer)
 - Консольные кабели для настройки устройств Cisco IOS через консольные порты.
 - Кабели Ethernet, расположенные в соответствии с топологией
##
# Инструкции:
##
## Часть 1. Создание сети и настройка основных параметров устройства
##
### Шаг 1. Создание сети согласно топологии.
Подключили устройства, как показано в топологии, и подсоединили необходимые кабели.
### Шаг 2. Произведение базовой настройки маршрутизаторов.
Откройте окно конфигурации
 - Назначение маршрутизатору имени устройства.
 - Отключение поиска DNS, чтобы предотвратить попытки маршрутизатора неверно преобразовывать введённые команды таким образом, как будто они являются именами узлов. 
 - Назначение **class** в качестве зашифрованного пароля привилегированного режима EXEC.
 - Назначение **cisco** в качестве пароля консоли и включение входа в систему по паролю.
 - Назначение **cisco** в качестве пароля VTY и включение входа в систему по паролю.
 - Шифрование открытых паролей.
 - Создание баннера с предупреждением о запрете несанкционированного доступа к устройству.
 - Сохранение текущей конфигурации в файл загрузочной конфигурации.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB11/Lab11_P1S2.JPG)

### Шаг 3. Настройка базовых параметров каждого коммутатора.
 - Назначение коммутатору имени устройства.
 - Отключение поиска DNS, чтобы предотвратить попытки маршрутизатора неверно преобразовывать введённые команды таким образом, как будто они являются именами узлов. 
 - Назначение **class** в качестве зашифрованного пароля привилегированного режима EXEC.
 - Назначение **cisco** в качестве пароля консоли и включите вход в систему по паролю.
 - Назначение **cisco** в качестве пароля VTY и включение входа в систему по паролю.
 - Шифрование открытых паролей.
 - Создание баннера с предупреждением о запрете несанкционированного доступа к устройству.
 - Сохранение текущей конфигурации в файл загрузочной конфигурации.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB11/Lab11_P1S3.JPG)

##
## Часть 2. Настройка и проверка базовой работы протокола OSPFv2 для одной области
##
 - Настройка адреса интерфейсов на каждом маршрутизаторе, как показано в таблице адресации выше.
 - Переход в режим конфигурации маршрутизатора OSPF, используя идентификатор процесса 56.
 - Настройка статического идентификатора маршрутизатора для каждого маршрутизатора (1.1.1.1 для R1, 2.2.2.2 для R2).
 - Настройка инструкции сети для сети между R1 и R2, поместив ее в область 0.
 - Только на R2 добавление конфигурацию, необходимой для объявления сети Loopback 1 в область OSPF 0.
 - Проверка того, что OSPFv2 работает между маршрутизаторами. Выполнение команды, чтобы убедиться, что R1 и R2 сформировали смежность.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB11/Lab11_P2S1af.JPG)

**Вопрос:** Какой маршрутизатор является DR? - R1
Какой маршрутизатор является BDR? - R2 
Каковы критерии отбора? - R1 был сконфигурирован с OSPF раньше, чем R2. Поэтому во время выбора OSPF был сконфигурирован только R1 и он же стал DR. Затем был сконфигурирован R2 и стал BDR на сегменте Gigabit. При выборе DR и BDR использовался роутер с наивысшим идентификатором.
 - На R1 выполнение команды **show ip route ospf**, чтобы убедиться, что сеть R2 Loopback1 присутствует в таблице маршрутизации. Поведение OSPF по умолчанию заключается в объявлении интерфейса обратной связи в качестве маршрута узла с использованием 32-битной маски.
 - Запуск Ping до адреса интерфейса R2 Loopback 1 из R1. Выполнение команды ping должно быть успешным.

![]()

##
## Часть 3. Оптимизация и проверка конфигурации OSPFv2 для одной области.
##
### Шаг 1. Реализация различных оптимизаций на каждом маршрутизаторе.
 - На R1 настройка приоритета OSPF интерфейса G0/0/1 на 50, чтобы убедиться, что R1 является назначенным маршрутизатором.
 - Настройка таймеров OSPF на G0/0/1 каждого маршрутизатора для таймера приветствия, составляющего 30 секунд.
 - На R1 настройка статического маршрута по умолчанию, который использует интерфейс Loopback 1 в качестве интерфейса выхода. Затем - распространение маршрута по умолчанию в OSPF и обращение внимания на сообщение консоли после установки маршрута по умолчанию.
 - Добаление конфигурации, необходимой для OSPF для обработки R2 Loopback 1 как сети точка-точка. Это приводит к тому, что OSPF объявляет Loopback 1 использует маску подсети интерфейса.
 - На R1 настройка приоритета OSPF интерфейса G0/0/1 на 50, чтобы убедиться, что R1 является назначенным маршрутизатором.
 - Только на R2 добавление конфигурации, необходимой для предотвращения отправки объявлений OSPF в сеть Loopback 1.
 - Изменение базовой пропускной способности для маршрутизаторов. После этой настройки - перезапуск OSPF с помощью команды **clear ip ospf process** и обращение внимания на сообщение консоли после установки новой опорной полосы пропускания.

![]()

### Шаг 2. Проверка того, что оптимизация OSPFv2 реализовалась.
 - Выполнение команды **show ip ospf interface g0/0/1** на R1 и проверка того, что приоритет интерфейса установлен равным 50, а временные интервалы — Hello 30, Dead 120, тип сети по умолчанию — Broadcast
 - Выполнение команды **show ip route ospf** на R1, чтобы убедиться, что сеть R2 Loopback1 присутствует в таблице маршрутизации. Нужно обратить внимание на разницу в метрике между этим выходным и предыдущим выходным. Также следует обратить внимание на то, что маска теперь составляет 24 бита, в отличие от 32 битов, ранее объявленных.
 - Ввод команды **show ip route ospf** на маршрутизаторе R2. Единственная информация о маршруте OSPF должна быть распространяемый по умолчанию маршрут R1.
 - Запуск Ping до адреса интерфейса R1 Loopback 1 из R2. Выполнение команды ping должно быть успешным.

![]()

**Вопрос:** Почему стоимость OSPF для маршрута по умолчанию отличается от стоимости OSPF в R1 для сети 192.168.1.0/24?

# Сводная таблица по интерфейсам маршрутизаторов

![](https://github.com/IvShikov/OtusLab/blob/main/LAB11/Lab11_Routing_table.JPG)


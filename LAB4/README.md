# Лабораторная работа № 4. Настройка IPv6-адресов на сетевых устройствах

![Lab4_Topology and table](https://github.com/IvShikov/OtusLab/blob/main/LAB4/Lab4_Topology%20and%20table.JPG)

# Задачи:
## Часть 1. Настройка топологии и конфигурация основных параметров маршрутизатора и коммутатора
## Часть 2. Ручная настройка IPv6-адресов
## Часть 3. Проверка сквозного соединения

# Общие сведения/сценарий:
В этой лабораторной работе будем настраивать хосты и интерфейсы устройств с IPv6-адресами. Для просмотра индивидуальных и групповых IPv6-адресов будем использовать команду **show**. Мы также будем проверять сквозное соединение с помощью команд **ping** and **traceroute**.

**Примечание:** Маршрутизаторы, используемые в практических лабораторных работах CCNA, - это Cisco 4221 с Cisco IOS XE Release 16.9.4 (образ universalk9). В лабораторных работах используются коммутаторы Cisco Catalyst 2960 с Cisco IOS версии 15.2(2) (образ lanbasek9). Можно использовать другие маршрутизаторы, коммутаторы и версии Cisco IOS. В зависимости от модели устройства и версии Cisco IOS доступные команды и результаты их выполнения могут отличаться от тех, которые показаны в лабораторных работах. Правильные идентификаторы интерфейса см. в сводной таблице по интерфейсам маршрутизаторов в конце лабораторной работы.

**Примечание:** Нужно убедиться, что у всех маршрутизаторов и коммутаторов была удалена начальная конфигурация. 

**Примечание.** Шаблон по умолчанию менеджера базы данных 2960 Switch Database Manager (SDM) не поддерживает IPv6. Перед назначением IPv6-адреса SVI VLAN 1 может понадобиться выполнение команды **sdm prefer dual-ipv4-and-ipv6 default** для включения IPv6-адресации.

**Примечание.** Шаблон default bias, который по умолчанию используется диспетчером SDM (диспетчер базы данных коммутатора), не предоставляет возможностей адресации IPv6. Нужно убедиться, что SDM использует шаблон dual-ipv4-and-ipv6 или lanbase-routing. Новый шаблон будет использоваться после перезагрузки.
S1# show sdm prefer
Чтобы установить шаблон dual-ipv4-and-ipv6 в качестве шаблона SDM по умолчанию, требуется выполнить следующие действия:
S1# configure terminal
S1(config)# sdm prefer dual-ipv4-and-ipv6 default
S1(config)# end
S1# reload

# Необходимые ресурсы:

 - 1 маршрутизатор (Cisco 4221 с универсальным образом Cisco IOS XE версии 16.9.4 или аналогичным);
 - 1 коммутатор (Cisco 2960 с ПО Cisco IOS версии 15.2(2) с образом lanbasek9 или аналогичная модель);
 - 2 ПК (Windows и программа эмуляции терминала, такая как Cisco Packet Tracer);
 - консольные кабели для настройки устройств Cisco IOS через консольные порты;
 - кабели Ethernet, расположенные в соответствии с топологией.

**Примечание.** Интерфейсы Gigabit Ethernet на маршрутизаторах Cisco 4321 определяют скорость автоматически, поэтому для подключения маршрутизатора к PC-B можно использовать прямой кабель Ethernet. При использовании другой модели маршрутизатора Cisco может возникнуть необходимость использовать перекрестный кабель Ethernet.
#
## Часть 1. Настройка топологии и конфигурация основных параметров маршрутизатора и коммутатора
После подключения сети, инициализации и перезагрузки маршрутизатора и коммутатора выполнили следующие действия:
### Шаг 1. Настройка маршрутизатора.
Назначили имя хоста и настроили основные параметры устройства.


### Шаг 2. Настройка коммутатора.
Назначили имя хоста и настроили основные параметры устройства.
#
## Часть 2. Ручная настройка IPv6-адресов
### Шаг 1. Назначение IPv6-адреса интерфейсам Ethernet на R1.
a. Назначили глобальные индивидуальные интерфейсам Ethernet на R1.
b. Ввели команду **show ipv6 interface brief**, чтобы проверить, назначен ли каждому интерфейсу корректный индивидуальный IPv6-адрес.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB4/Lab4_IPV6_R1.JPG)

**Примечание.** Отображаемый локальный адрес канала основан на адресации EUI-64, которая автоматически использует MAC-адрес интерфейса для создания 128-битного локального IPv6-адреса канала.
c. Чтобы обеспечить соответствие локальных адресов канала индивидуальному адресу, вручную ввели локальные адреса канала на каждом интерфейсе Ethernet на R1.

**Примечание.** Каждый интерфейс маршрутизатора относится к отдельной сети. Пакеты с локальным адресом канала никогда не выходят за пределы локальной сети, а значит, для обоих интерфейсов можно указывать один и тот же локальный адрес канала.
d. Использовали выбранную команду, чтобы убедиться, что локальный адрес связи изменен на fe80::1.
Закрыли окно настройки.
Интерфейсу G0/0  назначены следующие группы многоадресной рассылки:
ff02::1 и ff02::1:ff00:1.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB4/Lab4_IPV6_new_MulticastGroups%20.JPG)

### Шаг 2. Активация IPv6-маршрутизации на R1.
a. В командной строке на PC-B ввели команду **ipconfig**, чтобы получить данные IPv6-адреса, назначенного интерфейсу ПК.
Мы видим, что индивидуальный IPv6-адрес сетевой интерфейсной карте (NIC) на PC-B не назначен.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB4/Lab4_IPCONFIG%20R1.JPG)

b. Активировали IPv6-маршрутизацию на R1 с помощью команды **IPv6 unicast-routing**, чтобы убедиться, что новая многоадресная группа назначена интерфейсу G0/0/0. В списке групп для интерфейса G0/0 отображается группа многоадресной рассылки всех маршрутизаторов (FF02::2).

![](https://github.com/IvShikov/OtusLab/blob/main/LAB4/Lab4_Enable_IPV6_UnicastRouting_R1.JPG)

**Примечание.** Это позволит компьютерам получать IP-адреса и данные шлюза по умолчанию с помощью функции SLAAC (Stateless Address Autoconfiguration (Автоконфигурация без сохранения состояния адреса)).

![](https://github.com/IvShikov/OtusLab/blob/main/LAB4/Lab4_SLAAC.JPG)

c. Теперь, когда R1 входит в группу многоадресной рассылки всех маршрутизаторов, ещё раз ввели команду **ipconfig** на PC-B. Проверили данные IPv6-адреса.
PC-B получил глобальный префикс маршрутизации и идентификатор подсети, которые мы настроили на R1, потому что на R1 теперь все интерфейсы IPv6 являются частью группы многоадресной рассылки для всех маршрутизаторов (FF02::2). Это позволяет отправлять сообщения маршрутизатора с информацией об адресе глобальной сети и идентификаторе подсети на все узлы.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB4/Lab4_Afterautomst_IPconfIPv6conf.JPG)

### Шаг 3. Назначение IPv6-адреса интерфейсу управления (SVI) на S1.
a. Назначили адрес IPv6 для S1. Также назначили этому интерфейсу локальный адрес канала.

b. Проверили правильность назначения IPv6-адресов интерфейсу управления с помощью команды **show ipv6 interface vlan1**.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB4/Lab4_IPV6_Assign_S1.JPG)

Закрыли окно настройки.
### Шаг 4. Назначение компьютерам статических IPv6-адресов.
 - a. Открыли окно Свойства Ethernet для каждого ПК и назначили адресацию IPv6.
 - b. Убедились, что оба компьютера имеют правильную информацию адреса IPv6. Каждый компьютер должен иметь два глобальных адреса IPv6: один статический и один SLACC.
#
## Часть 3. Проверка сквозного подключения
Отправили эхо-запрос с PC-A  на FE80::1. Это локальный адрес канала, назначенный G0/1 на R1.
Отправили эхо-запрос на интерфейс управления S1 с PC-A.
Ввели команду **tracert на PC-A**, чтобы проверить наличие сквозного подключения к PC-B.
Отправили эхо-запрос с PC-B на PC-A.
Отправили эхо-запрос с PC-B на локальный адрес канала G0/0 на R1.

**Примечание.** В случае отсутствия сквозного подключения проверили, правильно ли указаны IPv6-адреса на всех устройствах.

**Вопросы для повторения:**
- Обоим интерфейсам Ethernet на R1 можно назначить один и тот же локальный адрес канала — FE80::1 потому, что локальные пакеты всегда остаются в локальной сети и один и тот же локальный адрес может использоваться на интерфейсе, связанном с другой локальной сетью.
 - В индивидуальном IPv6-адресе  2001:db8:acad::aaaa:1234/64 данный адрес - сжатый, а развёрнутый - 2001:db8:acad:**0000**:0000:0000:aaaa:1234/64, идентификатор подсети - это четвёртый стэк идентификатора подсети IPv6-адреса с префиксом 64, т.е. **0000**.

![Lab4](https://github.com/IvShikov/OtusLab/blob/main/LAB4/Lab4_Comparative%20routers%20table.JPG)

**Примечание.** Чтобы определить конфигурацию маршрутизатора, можно посмотреть на интерфейсы и установить тип маршрутизатора и количество его интерфейсов. Перечислить все комбинации конфигураций для каждого класса маршрутизаторов невозможно. Эта таблица содержит идентификаторы для возможных комбинаций интерфейсов Ethernet и последовательных интерфейсов на устройстве.
Другие типы интерфейсов в таблице не представлены, хотя они могут присутствовать в данном конкретном маршрутизаторе. В качестве примера можно привести интерфейс ISDN BRI. Строка в скобках — это официальное сокращение, которое можно использовать в командах Cisco IOS для обозначения интерфейса.

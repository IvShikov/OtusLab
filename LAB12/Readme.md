# Лабораторная работа №12. Настройка и проверка расширенных списков контроля доступа

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_Topology.JPG)

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_Adddressing%20table.JPG)

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_VLAN_table1.JPG)
![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_VLAN_table_2.JPG)

# Задачи:
## Часть 1. Создание и настройка основного сетевого устройства
## Часть 2. Настройка и проверка списков расширенного контроля доступа сети
## Часть 3. Настройка транков (магистральных каналов)
## Часть 4. Настройка маршрутизации
## Часть 5. Настройка удалённого доступа
## Часть 6. Проверка подключения
## Часть 7. Настройка и проверка списков контроля доступа (ACL)

# Общие сведения и сценарий
Поручено настроить списки контроля доступа в сети небольшой компании. ACL являются одним из самых простых и прямых средств управления трафиком уровня 3 R1 будет размещать интернет-соединение (смоделированное интерфейсом Loopback 1) и предоставлять информацию о маршруте по умолчанию для R2. После завершения первоначальной настройки компания имеет некоторые конкретные требования к безопасности дорожного движения, которые вы несете
ответственность за реализацию.

**Примечание:** Маршрутизаторы, используемые в практических лабораторных работах CCNA, - это Cisco 4221 с Cisco IOS XE Release 16.9.3 (образ universalk9). В лабораторных работах используются коммутаторы Cisco Catalyst 2960 с Cisco IOS версии 15.0(2) (образ lanbasek9). Можно использовать другие маршрутизаторы, коммутаторы и версии Cisco IOS. В зависимости от модели устройства и версии Cisco IOS доступные команды и результаты их выполнения могут отличаться от тех, которые показаны в лабораторных работах. Правильные идентификаторы интерфейса см. в сводной таблице
по интерфейсам маршрутизаторов в конце лабораторной работы.  

**Примечание**. Следует убедиться, что у всех маршрутизаторов и коммутаторов была удалена начальная конфигурация. 
# Необходимые ресурсы:
 - 2 маршрутизатора (Cisco 4221 с универсальным образом Cisco IOS XE версии 16.9.4 или аналогичным);
 - 2 коммутатора (Cisco 2960 с образом lanbasek9 Cisco IOS версии 15.2 (2) или аналогичным);
 - 2 ПК (ОС Windows с программой эмуляции терминалов, такой как Cisco Packet Tracer);
 - Консольные кабели для настройки устройств Cisco IOS через консольные порты;
 - Кабели Ethernet, расположенные в соответствии с топологией.
##
## Часть 1. Создание сети согласно топологии
Подключили устройства, как показано в топологии, и подсоединили необходимые кабели.
### Шаг 2. Произведение базовой настройки маршрутизаторов.
 - Назначение маршрутизатору имени устройства.
 - Отключение поиска DNS, чтобы предотвратить попытки маршрутизатора неверно преобразовывать введённые команды таким образом, как будто они являются именами узлов. 
 - Назначение **class** в качестве зашифрованного пароля привилегированного режима EXEC.
 - Назначение **cisco** в качестве пароля консоли и включение входа в систему по паролю.
 - Назначение **cisco** в качестве пароля VTY и включение входа в систему по паролю.
 - Шифрование открытых паролей.
 - Создание баннера с предупреждением о запрете несанкционированного доступа к устройству.
 - Сохранение текущей конфигурации в файл загрузочной конфигурации.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_P1S2_R1R2.JPG)

### Шаг 3. Настройка базовых параметров каждого коммутатора.
 - Назначение коммутатору имени устройства.
 - Отключение поиска DNS, чтобы предотвратить попытки маршрутизатора неверно преобразовывать введённые команды таким образом, как будто они являются именами узлов. 
 - Назначение **class** в качестве зашифрованного пароля привилегированного режима EXEC.
 - Назначение **cisco** в качестве пароля консоли и включите вход в систему по паролю.
 - Назначение **cisco** в качестве пароля VTY и включение входа в систему по паролю.
 - Шифрование открытых паролей.
 - Создание баннера с предупреждением о запрете несанкционированного доступа к устройству.
 - Сохранение текущей конфигурации в файл загрузочной конфигурации.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_P1S3_S1S2.JPG)

##
## Часть 2. Настройка сетей VLAN на коммутаторах
### Шаг 1. Создание сети VLAN на коммутаторах.
 - Создание необходимых VLAN и именование их на каждом коммутаторе из приведенной выше таблицы.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_P2S1a.JPG)

 - Настройка интерфейса управления и шлюза по умолчанию на каждом коммутаторе, используя информацию об IP-адресе в таблице адресации.
 - Назначение всех неиспользуемых портов коммутатора VLAN Parking Lot, настройка их для статического режима доступа и затем - их административное деактивирование.

**Примечание**. Команда **interface range** полезна для выполнения этой задачи с помощью необходимого количества команд.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_P2S1bc.JPG)

### Шаг 2. Назначение сети VLAN соответствующим интерфейсам коммутатора.
 - Назначение используемых порты соответствующей VLAN (указанной в таблице VLAN выше) и настройка их для режима статического доступа.
 - Выполение команды **show vlan brief**, чтобы убедиться, что сети VLAN назначены правильным интерфейсам.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_P2S2.JPG)

##
## Часть 3. Настройка транков (магистральных каналов)
### Шаг 1. Ручная настройка магистрального интерфейса F0/1.
 - Изменение режима порта коммутатора на интерфейсе F0/1, чтобы принудительно создать магистральную связь. Это нужно сделать на обоих коммутаторах.
 - В рамках конфигурации транка установка для native vlan значение 1000 на обоих коммутаторах. При настройке двух интерфейсов для разных собственных VLAN сообщения об ошибках могут отображаться временно.
 - В качестве другой части конфигурации транка следует указать, что VLAN 10, 20, 30 и 1000 разрешены в транке.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_P3S1.JPG)
 
 - Выполнение команды **show interfaces trunk** для проверки портов магистрали, собственной VLAN и разрешенных VLAN через магистраль.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_P3S2c.JPG)

### Шаг 2. Ручная настройка магистрального интерфейса F0/5 на коммутаторе S1.
 - Настройка интерфейса S1 F0/5 с теми же параметрами транка, что и F0/1. Это транк до маршрутизатора.
 - Сохранение текущей конфигурации в файл загрузочной конфигурации.
 - Использование команды **show interfaces trunk** для проверки настроек транка.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_P2S2.JPG)

##
## Часть 4. Настройка маршрутизации
### Шаг 1. Настройка маршрутизации между сетями VLAN на R1.
 - Активирование интерфейса G0/0/1 на маршрутизаторе.
 - Настройка подинтерфейсов для каждой VLAN, как указано в таблице IP-адресации. Все подинтерфейсы используют инкапсуляцию 802.1Q. Нужно убедиться, что подинтерфейс для собственной VLAN не имеет назначенного IP-адреса и включить описание для каждого подинтерфейса.
 - Настройка интерфейса Loopback 1 на R1 с адресацией из приведенной выше таблицы.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_P4S1ac.JPG)
  
 - С помощью команды **show ip interface brief** выполнение проверки конфигурации подинтерфейса.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_P4S1d.JPG)

### Шаг 2. Настройка интерфейса R2 g0/0/1 с использованием адреса из таблицы и маршрута по умолчанию с адресом следующего перехода 10.20.0.1.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_P4S2.JPG)
##
## Часть 5. Настройка удалённого доступа
### Шаг 1. Настройка всех сетевых устройств для базовой поддержки SSH.
 - Создание локального пользователя с именем пользователя **SSHadmin** и зашифрованным паролем **$cisco123!**
 - Задание **ccna-lab.com** в качестве доменного имени.
 - Генерация криптоключей с помощью 1024 битного модуля.
 - Настройка первых пяти линий VTY на каждом устройстве, чтобы поддерживать только SSH-соединения и с локальной аутентификацией.

### Шаг 2. Включение защищенных веб-служб с проверкой подлинности на R1.
 - Включение сервера HTTPS на R1.

R1(config)# ip http secure-server
 - Настройка R1 для проверки подлинности пользователей, пытающихся подключиться к веб-серверу.

R1(config)# ip http authentication local

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_P5.JPG)

##
## Часть 6. Проверка подключения
### Шаг 1. Настройка узлов ПК.
Адреса ПК можно посмотреть в таблице адресации.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_P6S1.JPG)

### Шаг 2. Выполение тестов. Эхо-запрос должен пройти успешно.
**Примечание**. Возможно, придётся отключить брандмауэр ПК для работы ping 

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_Tests%20for%20echo.JPG)

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_P6S2.JPG)

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_P6_Https_20.JPG)

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_P6_HTTPS_172.JPG)

##
## Часть 7. Настройка и проверка списков контроля доступа (ACL)
При проверке базового подключения компания требует реализации следующих политик безопасности:

**Политика1.** Сеть Sales не может использовать SSH в сети Management (но в другие сети SSH разрешен).

**Политика 2.** Сеть Sales не имеет доступа к IP-адресам в сети Management с помощью любого веб-протокола (HTTP/HTTPS). Сеть Sales также не имеет доступа к интерфейсам R1 с помощью любого веб-протокола. Разрешён весь другой веб-трафик (обратите внимание — Сеть Sales может получить доступ к интерфейсу Loopback 1 на R1).

**Политика3.** Сеть Sales не может отправлять эхо-запросы ICMP в сети Operations или Management. Разрешены эхо-запросы ICMP к другим адресатам. 

**Политика 4.** Cеть Operations не может отправлять ICMP эхозапросы в сеть Sales. Разрешены эхо-запросы ICMP к другим адресатам.

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_P7_Policies.JPG)

### Шаг 1. Анализ требований к сети и политике безопасности для планирования реализации ACL.
### Шаг 2. Разработка и применение расширенных списков доступа, которые будут соответствовать требованиям политики безопасности.
### Шаг 3. Проверка того, что политики безопасности применяются развёрнутыми списками доступа.
Выполнение нижеуказанных тестов. Ожидаемые результаты показаны в таблице:

![](https://github.com/IvShikov/OtusLab/blob/main/LAB12/Lab12_Testsesults_Ex.JPG)
